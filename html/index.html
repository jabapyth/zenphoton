<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>zen photon garden</title>
    <meta name="description" content="An interactive raytracer art-toy for HTML5 browsers." />
    <meta name="apple-mobile-web-app-title" content="Zen photon">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=1210, height=907, minimum-scale=0.2, user-scalable=yes" />
    <link rel="apple-touch-icon" href="logo-57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="logo-72.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="logo-114.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="logo-144.png" />
    <link rel="Shortcut Icon" href="favicon.ico" type="image/x-icon" />
    <script src='zenphoton.js' type='text/javascript'></script>
    <link rel="stylesheet" href="index.css" type="text/css" />
</head>
<body>
    <div id='centerColumn'>

        <h1>zen photon garden</h1>

        <div id='workspace'>
            <canvas id='histogramImage'></canvas>

            <div id='notsupported'>
                <h1>Oh no.</h1>
                <p>Zen photon garden is an interactive raytracer art-toy for HTML5 browsers.</p>
                <p>But it looks like your browser isn't supported!</p>
                <p>Try the latest version of Chrome or Firefox.</p>
                <p>(You'll need JavaScript, Canvas, Web Workers, and Typed Arrays.)</p>
            </div>

            <div id='help'>
                Draw on me.
            </div>

            <div id='leftColumn'>
                <div class='ui-box ui-inactive' id='pngButton'>Save PNG…</div>
                <div class='ui-box ui-inactive' id='linkButton'>Share link…</div>
                <div class='sep'>•</div>
                <div class='show-segments-on-hover'>
                    <div class='ui-box ui-inactive' id='undoButton'><span class='glyph'>↩</span>Undo</div>
                    <div class='ui-box ui-inactive' id='redoButton'><span class='glyph'>↪</span>Redo</div>
                    <div class='ui-box ui-inactive' id='clearButton'><span class='glyph'>×</span>Clear</div>
                </div>
                <div class='sep'>•</div>
                <div class='ui-box' id='diffuseSlider'><div class='ui-hslider'></div>Diffuse</div>
                <div class='ui-box' id='reflectiveSlider'><div class='ui-hslider'></div>Reflective</div>
                <div class='ui-box' id='transmissiveSlider'><div class='ui-hslider'></div>Transmissive</div>
            </div>

            <div id='rightColumn'>
                <div class='ui-box ui-inactive' id='exposureSlider'><span class='glyph'>↕</span>Exposure</div>
            </div>

        </div>

        <div class='hbox'>

            <div id='colophon'>
                <a target="_blank" href="http://scanlime.org/category/projects/zen-photon-garden/">blog</a>
                / <a target="_blank" href="https://github.com/scanlime/zenphoton">github</a>
            </div>

            <span class='label'>Rays traced:</span><span id='raysTraced'>0</span>
            <span class='sep'>•</span>
            <span class='label'>Speed:</span><span id='raySpeed'>0</span> rays/sec
        </div>
        <div class='hbox'>
          <div class='sides'>
            <textarea id='config' class='hcol'>
{
  "x0":           ["cx", 0, -100, 100],
  "y0":           ["cy", 0, -100, 100],
  "xoffset":      [100, 0, 500],
  "radius0":      [100, 10, 200],
  "finalRadius":  [200, 10, 400],
  "theta0":       [0, 0, 360],
  "segments":     [10, 3, 50],
  "segLength":    [1, 0,  10, 0.1],
  "numCircles":   [1, 0.1, 3, 0.1],
  "transmissive": [0.5, 0, 1],
  "diffuse":      [0,   0, 1],
  "reflective":   [0.5, 0, 1]
}
              </textarea>
              <div id="controls" class='hcol show-segments-on-hover'></div>
            </div>
            <textarea id='code'>
// calculated, cached constants
var deltaTheta  = (Math.PI * 2) * c.numCircles / c.segments
  , deltaRadius = (c.finalRadius - c.radius0) / c.segments;

// Create the walls
for (var i=0; i < c.segments; i+=1) {
  var theta1  = c.theta0*Math.PI/180  + i * deltaTheta
    , theta2  = theta1    +     deltaTheta * c.segLength
    , radius1 = c.radius0 + i * deltaRadius
    , radius2 = radius1   +     deltaRadius;

  add_wall(Math.cos(theta1) * radius1 + c.x0 + c.xoffset,
           Math.sin(theta1) * radius1 + c.y0,
           Math.cos(theta2) * radius2 + c.x0 + c.xoffset,
           Math.sin(theta2) * radius2 + c.y0,
           c.transmissive, c.reflective, c.diffuse);
  add_wall(-Math.cos(theta1) * radius1 + c.x0 - c.xoffset,
           Math.sin(theta1) * radius1 + c.y0,
           -Math.cos(theta2) * radius2 + c.x0 - c.xoffset,
           Math.sin(theta2) * radius2 + c.y0,
           c.transmissive, c.reflective, c.diffuse);
}
            </textarea>

</textarea>
            <div class='ui-button ui-inactive' id='evaluate-code'>Evaluate</div>
            <div id='error-msg'></div>
        </div>

    </div>
</body>
</html>
